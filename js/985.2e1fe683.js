"use strict";(globalThis["webpackChunkqrscanner"]=globalThis["webpackChunkqrscanner"]||[]).push([[985],{584:(e,t,l)=>{l.d(t,{Z:()=>s});l(702);var n=l(4682);function s(e,t,l){let s=[];for(let a of e)s.push(n.Z.scanImage(a));Promise.allSettled(s).then((n=>{let s={result:[],noResult:[]};n.forEach(((t,l)=>{"fulfilled"===t.status?s.result.push({file:e[l],result:t.value}):"rejected"===t.status&&s.noResult.push(e[l])})),s.result.length>0?t&&t(s):l&&l()}))}},1018:(e,t,l)=>{l.d(t,{Z:()=>q});var n=l(9835),s=l(6970);const a={class:"row justify-between"},o=["onClick"],r=(0,n.Uk)("Remove"),i=(0,n.Uk)("Copy"),c={key:0},u=(0,n._)("div",{class:"text-h6"},"Below Images has no result",-1),d={class:"row justify-between"};function m(e,t,l,m,h,p){const f=(0,n.up)("q-item-label"),g=(0,n.up)("q-img"),w=(0,n.up)("q-btn"),v=(0,n.up)("q-card-actions"),k=(0,n.up)("q-card");return(0,n.wg)(),(0,n.iD)("div",null,[null!==e.results?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[(0,n._)("div",a,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.res.result,((t,l)=>((0,n.wg)(),(0,n.j4)(k,{key:t.id,class:"m-img-w q-mb-sm"},{default:(0,n.w5)((()=>[(0,n.Wm)(g,{src:t.img},{default:(0,n.w5)((()=>[(0,n._)("div",{class:"absolute-bottom",onClick:l=>e.openUrl(t.value)},[(0,n.Wm)(f,{lines:"2",class:"text-body2"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,s.zw)(t.value),1)])),_:2},1024)],8,o)])),_:2},1032,["src"]),(0,n.Wm)(v,{class:"row justify-between"},{default:(0,n.w5)((()=>[(0,n.Wm)(w,{flat:"",onClick:n=>e.remove(t.id,l)},{default:(0,n.w5)((()=>[r])),_:2},1032,["onClick"]),(0,n.Wm)(w,{flat:"",onClick:l=>e.copyText(t.value)},{default:(0,n.w5)((()=>[i])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128))]),e.res.noResult.length>0?((0,n.wg)(),(0,n.iD)("div",c,[u,(0,n._)("div",d,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.res.noResult,(e=>((0,n.wg)(),(0,n.j4)(k,{key:e.id,class:"m-img-w q-mb-sm m-img-h"},{default:(0,n.w5)((()=>[(0,n.Wm)(g,{src:e.img},null,8,["src"])])),_:2},1024)))),128))])])):(0,n.kq)("",!0)],64)):(0,n.kq)("",!0)])}var h=l(499),p=l(61),f=l(9302);const g=(0,n.aZ)({props:["results"],setup(e){const t=(0,f.Z)(),l=(0,p.oR)();function s(e){return new Promise((t=>{let l=new FileReader;l.onload=()=>{t(l.result)},l.readAsDataURL(e)}))}const a="";let o=(0,h.qj)({result:[],noResult:[]});function r(e){0!==e.indexOf("http://")&&0!==e.indexOf("https://")||window.open(e)}function i(e){navigator.clipboard.writeText(e),t.notify("Copied!")}function c(e,t){o.result.splice(t,1),l.dispatch("scan/removeItem",{id:e})}return(0,n.m0)((()=>{null!==e.results&&e.results.result&&(o.result.length=0,o.noResult.length=0,e.results.result.forEach((e=>{let t=(0,h.qj)({img:a,...e.result});s(e.file).then((e=>t.img=e)),o.result.push(t)})),e.results.noResult.forEach(((e,t)=>{let l=(0,h.qj)({id:t,img:a});s(e).then((e=>l.img=e)),o.noResult.push(l)})))})),{res:o,openUrl:r,copyText:i,remove:c}}});var w=l(1639),v=l(4458),k=l(335),y=l(3115),Z=l(1821),C=l(4455),_=l(9984),R=l.n(_);const b=(0,w.Z)(g,[["render",m]]),q=b;R()(g,"components",{QCard:v.Z,QImg:k.Z,QItemLabel:y.Z,QCardActions:Z.Z,QBtn:C.Z})},1908:(e,t,l)=>{l.d(t,{Z:()=>C});var n=l(9835),s=l(6970);const a={class:"row items-center"},o=(0,n.Uk)("Delete");function r(e,t,l,r,i,c){const u=(0,n.up)("q-icon"),d=(0,n.up)("q-item-label"),m=(0,n.up)("q-item-section"),h=(0,n.up)("q-item"),p=(0,n.up)("q-slide-item"),f=(0,n.up)("q-list"),g=(0,n.Q2)("ripple");return(0,n.wg)(),(0,n.j4)(f,{bordered:""},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(l.list,(e=>((0,n.wg)(),(0,n.j4)(p,{onRight:t=>r.onRight(t,e.id),"right-color":"red",key:e.id},{right:(0,n.w5)((()=>[(0,n._)("div",a,[o,(0,n.Wm)(u,{right:"",name:"delete"})])])),default:(0,n.w5)((()=>[(0,n.wy)(((0,n.wg)(),(0,n.j4)(h,{clickable:""},{default:(0,n.w5)((()=>[(0,n.Wm)(m,{onClick:t=>r.openUrl(e)},{default:(0,n.w5)((()=>[(0,n.Wm)(d,{lines:"2"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,s.zw)(e.value),1)])),_:2},1024)])),_:2},1032,["onClick"]),(0,n.Wm)(m,{side:""},{default:(0,n.w5)((()=>[(0,n.Wm)(u,{name:"content_copy",color:"green",onClick:t=>r.copyText(e.value)},null,8,["onClick"])])),_:2},1024)])),_:2},1024)),[[g]])])),_:2},1032,["onRight"])))),128))])),_:1})}var i=l(61),c=l(9302);const u={name:"HistoryList",props:["list","temp"],setup(e){const t=(0,c.Z)(),l=(0,i.oR)();function s(e){navigator.clipboard.writeText(e),t.notify("Copied!")}function a(e){"url"===e.type&&window.open(e.value)}let o;function r(e){o=setTimeout((()=>{e()}),1e3)}function u({reset:n},s){t.notify("Removed"),r((()=>{n(),l.dispatch("scan/removeItem",{id:s,temp:e.temp})}))}return(0,n.Jd)((()=>{clearTimeout(o)})),{copyText:s,openUrl:a,onRight:u}}};var d=l(1639),m=l(3246),h=l(9254),p=l(2857),f=l(490),g=l(1233),w=l(3115),v=l(1136),k=l(9984),y=l.n(k);const Z=(0,d.Z)(u,[["render",r]]),C=Z;y()(u,"components",{QList:m.Z,QSlideItem:h.Z,QIcon:p.Z,QItem:f.Z,QItemSection:g.Z,QItemLabel:w.Z}),y()(u,"directives",{Ripple:v.Z})},9985:(e,t,l)=>{l.r(t),l.d(t,{default:()=>U});var n=l(9835);const s=(0,n._)("div",{class:"text-h6"},"Results",-1);function a(e,t,l,a,o,r){const i=(0,n.up)("ScanArea"),c=(0,n.up)("ResultArea"),u=(0,n.up)("q-card-section"),d=(0,n.up)("FileResult"),m=(0,n.up)("q-card"),h=(0,n.up)("q-dialog");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(i,{scanHeight:e.scanHeight},null,8,["scanHeight"]),(0,n.Wm)(c),(0,n.Wm)(h,{modelValue:e.fs.show,"onUpdate:modelValue":t[0]||(t[0]=t=>e.fs.show=t)},{default:(0,n.w5)((()=>[(0,n.Wm)(m,null,{default:(0,n.w5)((()=>[(0,n.Wm)(u,null,{default:(0,n.w5)((()=>[s])),_:1}),(0,n.Wm)(u,null,{default:(0,n.w5)((()=>[(0,n.Wm)(d,{results:e.fs.results},null,8,["results"])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}var o=l(499),r=l(61),i=l(6970),c=l(1957);const u={class:"btn-area flex justify-between"},d={class:"camera-area",ref:"vTag"};function m(e,t,l,s,a,o){const r=(0,n.up)("q-btn");return(0,n.wg)(),(0,n.iD)("div",{class:"video-container flex flex-center",style:(0,i.j5)({"--qr-hl":s.hl_w+"px","--scan-height":l.scanHeight+"px"})},[(0,n.wy)((0,n._)("div",u,[(0,n.Wm)(r,{round:"",color:"grey-9",icon:"close",onClick:s.closePage},null,8,["onClick"]),(0,n.Wm)(r,{round:"",color:"grey-9",icon:s.camPaused?"play_arrow":"pause",onClick:s.pauseCam},null,8,["icon","onClick"]),s.flashState>0?((0,n.wg)(),(0,n.j4)(r,{key:0,round:"",color:"grey-9",icon:s.flashIcon,onClick:s.toggleFlash},null,8,["icon","onClick"])):(0,n.kq)("",!0),(0,n.Wm)(r,{round:"",color:"grey-9",icon:"wallpaper",onClick:s.inputImages},null,8,["onClick"])],512),[[c.F8,s.camEnabled]]),(0,n._)("video",d,null,512)],4)}l(8964);var h=l(6644),p=l(9302),f=l(4682);function g(){return new Promise(((e,t)=>{let l=document.createElement("input");l.type="file",l.multiple=!0,l.accept="image/*",l.onchange=t=>{e(t.target.files)},l.click()}))}var w=l(584);const v={name:"ScanArea",props:["scanHeight"],setup(){const e=(0,r.oR)(),t=(0,h.tv)(),l=(0,p.Z)(),s=f.Z.hasCamera();let a=(0,o.iH)(null),i=(0,o.iH)(!1),c=null,u="",d=(0,o.iH)(400);function m(){let e=document.body.scrollWidth;d.value=e<=500?.9*e:450}function v(){try{const e=c.start();e.then((()=>{console.log("camera permission granted"),i.value=!0})).catch((e=>{console.error("camera permission needed!",e),i.value=!1}))}catch(e){console.error(e)}}window.addEventListener("resize",(()=>m()));let k=(0,o.iH)(0);function y(){k.value=!k.value,k.value?c.stop():v()}function Z(){k.value=!0,c.stop()}(0,n.bv)((()=>{m(),s.then((t=>{t?(e.dispatch("scan/hasCamera",!0),(0,n.Y3)((()=>{c=new f.Z(a.value,(({data:t})=>{u!==t&&(u=t,e.dispatch("scan/scanResult",t))}),{highlightScanRegion:!0,highlightCodeOutline:!0}),v()}))):e.dispatch("scan/hasCamera",!1)})).catch((e=>console.error(e)))}));let C=(0,o.iH)(-1),_=(0,n.Fl)((()=>1===C.value?"flash_off":2===C.value?"flash_on":"no_flash"));function R(){if(!(C.value<1))if(1===C.value)try{c.turnFlashOn().then((e=>{e&&(C.value=2)}))}catch(e){console.error("err in turning on flash",e)}else try{c.turnFlashOff().then((e=>{e&&(C.value=1)}))}catch(e){console.error("err in turning off flash",e)}}function b(){e.dispatch("scan/scanClear",0),c.stop(),t.replace("/")}function q(){let t=g();t.then((t=>{(0,w.Z)(t,(t=>{Z(),e.dispatch("scan/newImages",t)}),(()=>{l.notify("None has Result!")}))})).catch((e=>console.error(e)))}return(0,n.m0)((()=>{!0===i.value&&-1===C.value&&c.hasFlash().then((e=>{C.value=e?1:0})).catch((e=>console.error("flash err: ",e)))})),{vTag:a,closePage:b,camPaused:k,pauseCam:y,camEnabled:i,hl_w:d,flashState:C,flashIcon:_,toggleFlash:R,inputImages:q}}};var k=l(1639),y=l(4455),Z=l(9984),C=l.n(Z);const _=(0,k.Z)(v,[["render",m]]),R=_;function b(e,t,l,s,a,o){const r=(0,n.up)("HistoryList"),i=(0,n.up)("q-card");return(0,n.wg)(),(0,n.j4)(i,{class:"result-card",ref:"cheight"},{default:(0,n.w5)((()=>[(0,n.Wm)(r,{class:"result-list",list:s.list,temp:!0},null,8,["list"])])),_:1},512)}C()(v,"components",{QBtn:y.Z});var q=l(1908);const H={name:"ResultArea",components:{HistoryList:q.Z},setup(){const e=(0,r.oR)(),t=(0,o.qj)([]);let l=(0,o.iH)(null);return(0,n.m0)((()=>{t.length=0,Object.assign(t,e.state.scan.currentResult),(0,n.Y3)((()=>{let t=0;null!==l.value&&(t=l.value.$el.clientHeight),e.dispatch("scan/listHeight",t)}))})),{list:t,cheight:l}}};var W=l(4458);const j=(0,k.Z)(H,[["render",b]]),I=j;C()(H,"components",{QCard:W.Z});var Q=l(1018);const x=(0,n.aZ)({name:"ScanPage",components:{ScanArea:R,ResultArea:I,FileResult:Q.Z},setup(){const e=(0,r.oR)();let t=(0,o.qj)({show:!1,results:null});(0,n.bv)((()=>{(0,n.m0)((()=>{s(),t.results=e.state.scan.newImgs,null!==t.results?t.show=!0:t.show=!1}))}));let l=(0,o.iH)(window.innerHeight);function s(){let t=e.state.scan.resultHeight,n=window.innerHeight,s=t/n;l.value=s<.2?n:s>=.2&&s<.3?.9*n:s>=.3&&s<.35?.8*n:s>=.35&&s<.42?.75*n:s>=.42&&s<.5?.68*n:s>=.5&&s<.56?.6*n:n}return{scanHeight:l,fs:t}}});var T=l(5263),D=l(3190);const S=(0,k.Z)(x,[["render",a]]),U=S;C()(x,"components",{QDialog:T.Z,QCard:W.Z,QCardSection:D.Z})}}]);